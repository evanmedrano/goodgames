<h1><%= @game.name %></h1> 
<%#= image_tag @game.background_image, class: "card__image" %>

<!-- Only show comments for games that are persisted in the database -->
<% if @game.is_a?(Game) %>
  <h2>Comments</h2>
  <% @comments.each do |comment| %>
    <h3><%= comment.title %></h3>
    <p><%= comment.body %></p>
    <p>- <%= comment.user_name %></p>
    <% if comment.user == current_user %>
      <%= link_to "Edit comment", edit_game_comment_path(game_id: @game.id, id: comment.id) %>
      <%= link_to "Delete comment", game_comment_path(game_id: @game.id, id: comment.id), method: :delete, data: { confirm: "Are you sure?" } %>
    <% end %>
  <% end %>
  <%= link_to "Add a comment", new_game_comment_path(@game) %>
  <%= link_to "All comments", game_comments_path(@game) %>
<% end %>

<% if @game.platforms.present? %>
  <% @game.platforms.each do |platform| %>
    <%= link_to platform, platform_path(convert_to_slug(platform)) %>
  <% end %>
<% end %>

<p><%= @game.released %></p>

<h1>Genres</h1>
<%# @game.genres.each do |genre| %>
  <%#= link_to genre, genre_path(genre) %>
<%# end %>

<h1>Screenshots</h1>
<% @game_screenshots.each do |screenshot| %>
  <%= image_tag "#{screenshot["image"]}" %>
<% end %>
<% if !user_signed_in? || (user_signed_in? && !current_user.added_game?(@game)) %>
  <%= link_to "Add to library", games_path(game: { slug: @game.slug }), method: :post %>
<% else %>
  <%= link_to "Remove from library", user_game_path(@game), method: :delete, 
    data: { confirm: 'Are you sure you want to remove this game from your library?'} %>
<% end %>

<h1>Also from the same series as <%= @game.name %></h1>
<%= render 'games', games: @series_games, user: current_user %>

<h1>Similar games</h1>
<%= render 'games', games: @similar_games, user: current_user %>

<% if !@users_who_beat_game.nil? && @users_who_beat_game.size > 0 %>
  <h1>Users who have beat <%= @game.name %> </h1>
  <% @users_who_beat_game.each do |user| %>
    <h2><%= link_to user.name, games_user_path(user) %></h2>
  <% end %>
<% end %>

<% if !@users_who_are_playing.nil? && @users_who_are_playing.size > 0  %>
  <h1>Users who are playing <%= @game.name %></h1>
  <% @users_who_are_playing.each do |user| %>
    <h2><%= link_to user.name, games_user_path(user) %></h2>
  <% end %>
<% end %>