<h1>Search for a game!</h1>

<%= form_tag search_games_path, method: :get do %>
  <%= text_field_tag :name, nil, placeholder: "Search 347,170 games!" %>
  <%= submit_tag "Search", name: nil %>
<% end %>
 
<div class="card__container">
  <% if @games.present? %>
    <% @games.each do |game| %>
      <%#= link_to game_path(game["slug"]) do %>
      <div class="card" >
        <h1><%= game["name"] %></h1> 
        <%= image_tag "#{game["background_image"]}", class: "card__image" %>

        <% if game["platforms"].present? %>
          <% game["platforms"].each do |platform| %>
            <span><%= game.is_a?(Hash) ? platform["platform"]["name"] : platform %></span>
          <% end %>
        <% end %>
        <p><%= game["released"] %></p>
        
        <div class="card__btn-wrapper">
          <%= button_to "Show more", game_path(game["slug"]), method: :get, class: "card__btn btn btn--small" %>
          <% if !user_signed_in? || user_signed_in? && !current_user.added_game?(game) %>
            <%= button_to "Add to library", user_games_path(user_game: { game_id: game["slug"], user_id: current_user }), 
              class: "card__btn btn btn--small" %>
          <% else %>
            <%= button_to "Remove from library", user_game_path(game["slug"]), method: :delete, 
              data: { confirm: 'Are you sure you want to remove this game from your library?'}, class: "card__btn btn btn--small" %>
          <% end %>
        </div>
      </div> <!--/Card-->
      <%# end %>
    <% end %>
    
  <% end %> 
</div>
